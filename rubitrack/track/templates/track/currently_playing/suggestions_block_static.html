{% load musical_key_filters %}
<div id="suggestions-block-static" class="suggestions-container">
  <h3>Suggestions</h3>
  <div class="table-container">
    <table class="suggestions-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Artist</th>
          <th>Genre</th>
          <th>BPM</th>
          <th>Musical Key</th>
          <th>Comment</th>
          <th>Ranking</th>
          <th>Playcount</th>
          {# Removed Traktor Order header #}
        </tr>
      </thead>
      <tbody>
        {% for s in listTrackSuggestions %}
          <tr class="track-row">
            <td><a href="{% url 'history_editing_view' s.id %}">{{ s.title }}</a></td>
            <td><span class="artist_green_flashy"><a href="{% url 'history_editing_view' s.id %}">{% if s.artist %}{{ s.artist.name }}{% elif s.artist_name %}{{ s.artist_name }}{% else %}--{% endif %}</a></span></td>
            <td><span class="genre-badge">{% if s.genre and s.genre.name %}{{ s.genre.name }}{% elif s.genre %}{{ s.genre }}{% else %}--{% endif %}</span></td>
            <td>{% if s.bpm %}{{ s.bpm|floatformat:1 }}{% else %}--{% endif %}</td>
            <td>
              {% if s.musical_key %}{% musical_key_badge s.musical_key %}{% else %}--{% endif %}
              {% if s.musical_key_distance %}<span style="color:#888;font-size:10px;margin-left:4px;">{{ s.musical_key_distance }}{% if s.musical_key_order %} ({{ s.musical_key_order }}){% endif %}</span>{% elif s.musical_key_order %}<span style="color:#888;font-size:10px;margin-left:4px;">({{ s.musical_key_order }})</span>{% endif %}
            </td>
            <td>{{ s.comment|default:"--" }}</td>
            <td>
              {% if s.ranking %}
                <span class="ranking-stars">
                  {% for i in "12345" %}{% if forloop.counter <= s.ranking %}★{% else %}☆{% endif %}{% endfor %}
                </span>
              {% else %}--{% endif %}
            </td>
            <td>{{ s.playcount|default:0 }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="8" class="no-suggestions">Aucune suggestion.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<style>
/* Reuse styles (light subset) */
#suggestions-block-static .suggestions-table { width:100%; border-collapse:collapse; background:#fff; }
#suggestions-block-static th, #suggestions-block-static td { padding:8px 6px; border-bottom:1px solid #eee; font-size:13px; }
#suggestions-block-static th { background:#f8f9fa; font-weight:bold; }
#suggestions-block-static .genre-badge, #suggestions-block-static .musical-key-badge { display:inline-block; padding:2px 6px; border-radius:4px; font-size:11px; font-weight:bold; background:#6c757d; color:#fff; }
#suggestions-block-static .musical-key-badge { background:#17a2b8; }
#suggestions-block-static .ranking-stars { color:#ffc107; font-size:13px; }
</style>
